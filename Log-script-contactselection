% This code has been created to select contacts for repeated-measure
% analyses basing on their high-gamma response to the stimulus compared to
% the baseline activity (data-drive approach). 
% the analysis includes baseline correction (division) and paired-t-test
% analysis between the post-stimulus period and the baseline 

% The input dataset(s) must be a data structure as obtained by fieldtrip preprocessing
% e.g. having:
% hdr 1x1 structure
% trial = 1 x ntrials per block cell
% fsample
% label = n contacts x 1 cell (labels of the contacts)
% trialinfo = ntrials x n (n = number of features per each trial [e.g. RT, accuracy ...])
% sampleinfo = ntrials x 2 (for each trial the first and last timestamp)


%% log for contact selection 

nblocks = 8; %number of blocks (conditions) of the experiment
params = []; %create parameter structure
params.ssID        = 'pt1';
params.pathPREPRO    = '\'; %path of preprocessed data 

for ii = 1: nblocks
    eval(sprintf('params.dataprepro_b_%d    = ''%s_b%d_preproHILB_AVG.mat'';', params.ssID ii));
end

params.OutPath     = '\';   %path to save output
params.trigchan    = {'-DC DC09'};   %trigger channel
data_preprocessed =  ''  % name of your datafile 

tbaseline = [-0.5 -0.05];    %baseline in seconds 
stim_time = 2001;            %when the stimulus appears in milliseconds 
ntimewindows = 2;            %number of time windows to be analysed

%time windows in milliseconds (0 = stimulus)
temp_wind1_msec = [0 150];   
temp_wind2_msec = [150 350]; 

